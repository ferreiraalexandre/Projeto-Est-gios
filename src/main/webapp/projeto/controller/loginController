project.controller('LoginCtrl', ['$location', '$localStorage', '$http', '$scope', '$route', '$routeParams', '$mdSidenav', 'LoginService', 'ToastService', 'UserService', 'UnityService',
	function ($location, $localStorage, $http, $scope, $route, $routeParams, $mdSidenav, LoginService, ToastService, UserService, UnityService) {

		$scope.login = function (event, User) {

			if (User.password) {
				User.password = btoa(User.password);
			}
			LoginService.auth(User, function (response) {
				if (response.data) {
					$localStorage.currentUser = { email: User.email, token: response.data.token, permission: response.data.permission, adm: response.data.adm };

					$scope.getData();

				}
			}, function (err) {
				User.password = "";
				ToastService.alert(err.data.message);
			})
		};

		$scope.toDashBoard = function () {
			$location.path('/');
		};

		$scope.logout = function (event) {
			$localStorage.$reset();
			$location.path('/login');
		};